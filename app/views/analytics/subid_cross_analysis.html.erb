<div class="max-w-7xl mx-auto p-6">
  <h1 class="text-2xl font-bold mb-6">Análise Cruzada: Cliques x Comissões por Campanha (SubID)</h1>

  <div class="bg-white rounded-lg shadow p-4 mb-6">
    <form method="get" action="<%= subid_cross_analysis_path %>" class="flex flex-wrap items-end gap-4">
      <div class="flex flex-col">
        <label for="start_date" class="text-sm font-medium text-gray-700 mb-1">Data Inicial</label>
        <input type="date" id="start_date" name="start_date" value="<%= params[:start_date] %>" class="border border-gray-300 rounded-md px-3 py-2 text-sm">
      </div>
      <div class="flex flex-col">
        <label for="end_date" class="text-sm font-medium text-gray-700 mb-1">Data Final</label>
        <input type="date" id="end_date" name="end_date" value="<%= params[:end_date] %>" class="border border-gray-300 rounded-md px-3 py-2 text-sm">
      </div>
      <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md text-sm font-medium transition-colors flex items-center">
        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"></path>
        </svg>
        Filtrar
      </button>
    </form>
  </div>

  <div class="overflow-x-auto">
    <table class="min-w-full divide-y divide-gray-200">
      <thead class="bg-gray-50">
        <tr>
          <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Campanha (SubID)</th>
          <th class="px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase">Cliques</th>
          <th class="px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase">Pedidos</th>
          <th class="px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase">Conversão (%)</th>
          <th class="px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase">Comissão</th>
          <th class="px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase">Receita</th>
          <th class="px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase">Gasto Ads</th>
          <th class="px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase">ROI (%)</th>
        </tr>
      </thead>
      <tbody class="bg-white divide-y divide-gray-200">
        <% @subid_cross_data.each do |row| %>
          <tr>
            <td class="px-4 py-2 whitespace-nowrap text-gray-900"><%= row[:subid] %></td>
            <td class="px-4 py-2 whitespace-nowrap text-right"><%= number_with_delimiter(row[:clicks]) %></td>
            <td class="px-4 py-2 whitespace-nowrap text-right"><%= number_with_delimiter(row[:orders]) %></td>
            <td class="px-4 py-2 whitespace-nowrap text-right"><%= row[:conversion] %></td>
            <td class="px-4 py-2 whitespace-nowrap text-right"><%= number_to_currency(row[:commission], unit: 'R$ ', separator: ',', delimiter: '.') %></td>
            <td class="px-4 py-2 whitespace-nowrap text-right"><%= number_to_currency(row[:sales], unit: 'R$ ', separator: ',', delimiter: '.') %></td>
            <td class="px-4 py-2 whitespace-nowrap text-right"><%= row[:ad_spend].to_f > 0 ? number_to_currency(row[:ad_spend], unit: 'R$ ', separator: ',', delimiter: '.') : '-' %></td>
            <td class="px-4 py-2 whitespace-nowrap text-right"><%= row[:roi].present? ? row[:roi] : '-' %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
    <% if @subid_cross_data.empty? %>
      <div class="text-center text-gray-500 py-8">Nenhum dado encontrado para o período selecionado.</div>
    <% end %>
  </div>
</div>
